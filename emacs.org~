#+title: Emacs Configuration
#+property: header-args:emacs-lisp :tangle yes :results output none

* Appearence
** General
#+begin_src emacs-lisp
  (setopt default-frame-alist '((undecorated . t)))
  (menu-bar-mode -1)
  (tool-bar-mode -1)
  (scroll-bar-mode -1)
  (pixel-scroll-precision-mode)
  (global-set-key [f12] 'eval-buffer)
  ;; juste evaluer le paragraphe de texte en orgmode
  (global-display-line-numbers-mode 1)
  (electric-pair-mode)
  (delete-selection-mode t)
  (global-aggressive-indent-mode)
  (setopt tab-always-indent 'complete
        visible-bell t
        read-extended-command-predicate #'command-completion-default-include-p
        text-mode-ispell-word-completion nil)
  (add-hook 'prog-mode 'hs-minor-mode)
#+end_src

** Themes
#+begin_src emacs-lisp
  (defvar my-themes '(exotica chyla white-sand gruvbox-dark-hard))

  (defun cycle-themes ()
    (interactive)
    (let* ((current-theme (car custom-enabled-themes))
           (next-theme (or (cadr (member current-theme my-themes))
                           (car my-themes))))
      (disable-theme current-theme)
      (load-theme next-theme t)
      (message "%s" next-theme)))

  (load-theme (car my-themes) t)
  (global-set-key (kbd "C-\\") 'cycle-themes)
#+end_src

** Completion
#+begin_src emacs-lisp

  (global-corfu-mode)
  (setopt corfu-auto nil)


  (setopt completion-styles '(orderless basic)
        completion-category-defaults nil
        completion-category-overrides '((file (styles partial-completion)))
        read-file-name-completion-ignore-case t
        read-buffer-completion-ignore-case t
        completion-ignore-case t)

  (setopt marginalia-align 'right)
  (marginalia-mode)

  (when (display-graphic-p)
    (require 'all-the-icons)
    (all-the-icons-completion-mode)
    (add-hook 'marginalia-mode-hook #'all-the-icons-completion-marginalia-setup))

  (setopt vertico-count 15
  	vertico-resize nil
  	vertico-cycle t)
  (vertico-mode)

  (which-key-mode)
#+end_src

** Orgmode
#+begin_src emacs-lisp
  (custom-set-faces
   '(org-document-title ((t (:height 1.50))))
   '(org-level-1 ((t (:height 1.37))))
   '(org-level-2 ((t (:height 1.25))))
   '(org-level-3 ((t (:height 1.12)))))
  (setopt org-startup-indented t
          org-startup-align-all-tables t
          org-startup-numerated nil
          org-hide-leading-stars t
          org-return-follows-link  t)
    (add-hook 'org-mode-hook 'org-indent-mode)
    (add-hook 'org-mode-hook 'visual-line-mode)

  (add-hook 'org-mode-hook 'org-appear-mode)
    (setopt org-hide-emphasis-markers t)

    (add-hook 'org-mode-hook 'org-superstar-mode)
#+end_src

* Editing
** Completion
#+begin_src emacs-lisp
  (setopt lsp-keymap-prefix "C-c l")
  (require 'lsp-mode)
  (add-hook 'nix-mode-hook #'lsp-deferred)
  (add-hook 'lsp-mode-hook #'lsp-enable-which-key-integration)
#+end_src

** Linting
#+begin_src emacs-lisp
  (setopt flycheck-emacs-lisp-load-path 'inherit)
  (global-flycheck-mode)

  (defun disable-flycheck-in-org-src-block ()
    (setq-local flycheck-disabled-checkers '(emacs-lisp-checkdoc)))
  (add-hook 'org-src-mode-hook #'disable-flycheck-in-org-src-block)
#+end_src

** File Tree
#+begin_src emacs-lisp
  (setopt treemacs-position 'right)
#+end_src
